{% extends "base" %}

{% block content %}
<main class="one-column-page" id="user-comments-page">
  <div class="comments">
    Comments for {{ profile_user.username }}

    <ol>
      {% for result in comments_with_uploads %}
        {% set comment = result.0 %}
        {% set upload = result.1 %}
        
        <li class="comment">
          <div class="timestamp">{{ comment.created_at | date(format="%Y-%m-%d %H:%M") }}</div>
          <div class="title">
            <span class="username">{{ profile_user.username }}</span>
            commented on <a href="/u/{{ upload.file_id }}">#{{ upload.file_id}}</a>.
          </div>
          <div class="content">
            {{ comment.comment | from_markdown }}
          </div>
        </li>
      {% endfor %}
    </ol>
  </div>
  {% if page_count -%}
  <div class="pagination">
    {% for i in range(start=1, end=5) | reverse -%}
      {% if page - i > 0 -%}
        <a href="/user/{{ profile_user.username }}/comments?page={{ page - i}}">{{ page - i}}</a>
      {% endif -%}
    {% endfor -%}

    <span>{{page}}</span>

    {% if page_count > page -%}
      {% for i in range(start=1, end=5) -%}
        {% if page + i <= page_count -%}
          <a href="/user/{{ profile_user.username }}/comments?page={{ page + i}}">{{ page + i}}</a>
        {% endif -%}
      {% endfor -%}

      {% if page + 5 <= page_count -%}
      <span>...</span>
      <a href="/user/{{ profile_user.username }}/comments?page={{ page_count }}">{{ page_count }}</a>
      {% endif -%}
    {% endif -%}
  </div>
  {% endif -%}
</main>
{% endblock content %}